"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),DefaultHTML=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"generate",value:function(t){var e={};e.panel=$("<div>",{class:"panel"}).appendTo(t);var n=e.panel;return e.panelTop=$("<div>",{class:"panel-top"}).appendTo(n),e.indicator=$("<div>",{class:"indicator"}).appendTo(e.panelTop),e.topIcon=$("<div>",{class:"panel-icon"}).appendTo(e.panelTop),e.panelContent=$("<div>",{class:"panel-content"}).appendTo(e.panelTop),e.title=$("<h2>",{class:"title"}).appendTo(e.panelContent),e.topValue=$("<div>",{class:"top-value"}).appendTo(e.panelContent),e.counterWrapper=$("<div>",{class:"counter-wrapper"}).appendTo(e.topValue),e.counter=$("<div>",{class:"counter"}).appendTo(e.counterWrapper),e.topUnit=$("<div>",{class:"top-unit"}).appendTo(e.topValue),e.topDescription=$("<p>",{class:"top-description"}).appendTo(e.panelContent),e.panelBottom=$("<div>",{class:"panel-bottom"}).appendTo(n),e.bottomTop=$("<div>",{class:"top"}).appendTo(e.panelBottom),e.btText=$("<p>",{class:"description"}).appendTo(e.bottomTop),e.btValue=$("<p>",{class:"value"}).appendTo(e.bottomTop),e.bottomBottom=$("<div>",{class:"bottom"}).appendTo(e.panelBottom),e.bbText=$("<p>",{class:"description"}).appendTo(e.bottomBottom),e.bbValue=$("<p>",{class:"value"}).appendTo(e.bottomBottom),e}}]),t}(),_createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),IndicatorColor=function(){function t(e,n){arguments.length>2&&void 0!==arguments[2]&&arguments[2];_classCallCheck(this,t),this.comparativeValue=e,this.settings={reverse:n,positive:"#a0c756",negative:"#ea8639"}}return _createClass(t,[{key:"setParent",value:function(t){this.indicator=t}},{key:"setColor",value:function(t){this.indicator.css({"background-color":t})}},{key:"update",value:function(t){this.flipped===!1&&(this.settings.reverse?t<this.comparativeValue?this.setColor(this.settings.negative,!0):this.setColor(this.settings.positive,!0):t>this.comparativeValue?this.setColor(this.settings.negative,!0):this.setColor(this.settings.positive,!0))}},{key:"start",value:function(){this.flipped=!1;var t=this.settings.reverse?this.settings.negative:this.settings.positive;this.setColor(t,!1)}}]),t}(),_createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),IndicatorImage=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,t),this.comparativeValue=e,this.settings={reverse:!!n.reverse&&n.reverse,imagesPath:n.imagesPath?n.imagesPath:"./images/",positive:n.positiveImage?n.positiveImage:"indicator-up.svg",negative:n.negativeImage?n.negativeImage:"indicator-down.svg"}}return _createClass(t,[{key:"setParent",value:function(t){this.indicator=t.append('<img src="" style="display: none">').find("img")}},{key:"setImage",value:function(t){this.indicator.attr({src:this.settings.imagesPath+t,style:"display: block"})}},{key:"update",value:function(t){this.flipped===!1&&(this.settings.reverse&&t<this.comparativeValue?(this.flipped=!0,this.setImage(this.settings.negative,!0)):t>this.comparativeValue&&(this.flipped=!0,this.setImage(this.settings.positive,!0)))}},{key:"start",value:function(){this.flipped=!1;var t=this.settings.reverse?this.settings.positive:this.settings.negative;this.setImage(t,!1)}}]),t}(),_createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),NameFlipper=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,t),this.males=e.male,this.females=e.female,this.settings={startAt:n.startAt?n.startAt:0,duration:n.duration?n.duration:5e3,maleEndAt:n.maleEndAt?n.maleEndAt:this.males.length-1,femaleEndAt:n.femaleEndAt?n.femaleEndAt:this.females.length-1,easing:n.easing?n.easing:TWEEN.Easing.Exponential.Out}}return _createClass(t,[{key:"setParent",value:function(t){this.topName=t.find(".top > .value").addClass("female"),this.bottomName=t.find(".bottom > .value").addClass("male"),t.find(".top > .description").addClass("name-flipper"),t.find(".bottom > .description").addClass("name-flipper")}},{key:"setNames",value:function(){this.topName.html(this.females[Math.ceil(this.current.female)].name),this.bottomName.html(this.males[Math.ceil(this.current.male)].name)}},{key:"setAnimator",value:function(t,e,n,a,i){this.animator=new TWEEN.Tween(t).to(e,n).easing(i).onUpdate(a).start()}},{key:"start",value:function(){this.current={male:this.settings.startAt,female:this.settings.startAt},this.target={male:this.settings.maleEndAt,female:this.settings.femaleEndAt},this.setAnimator(this.current,this.target,this.settings.duration,this.setNames.bind(this),this.settings.easing)}}]),t}(),_createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),Counter=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,t),this.listeners=[],this.settings={minimumDigits:e.minimumDigits?e.minimumDigits:4,digitWidth:e.digitWidth?e.digitWidth:.7,digitDivider:e.digitDivider?e.digitDivider:".",startAt:e.startAt?e.startAt:0,endAt:e.endAt?e.endAt:1e3,duration:e.duration?e.duration:5e3,easing:e.easing?e.easing:TWEEN.Easing.Sinusoidal.InOut}}return _createClass(t,[{key:"setParent",value:function(t){this.counter=t.append('<div class="digits">'+this.settings.startAt+"</div>").find(".digits"),this.setTime(this.settings.startAt)}},{key:"setTime",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.current.time;this.formatted=parseInt(t).toString(),this.digitCount=this.formatted.length,this.digitCount>3&&(this.formatted=this.formatted.slice(0,-3)+this.settings.digitDivider+this.formatted.slice(-3)),this.digitCount>6&&(this.formatted=this.formatted.slice(0,-7)+this.settings.digitDivider+this.formatted.slice(-7)),this.counter.html(this.formatted)}},{key:"setAnimator",value:function(t,e,n,a){var i=this,s=this;s.animator=new TWEEN.Tween(t).to(e,n).easing(a).onUpdate(function(){s.setTime(),s.listeners.forEach(function(t){t.update(i.current.time)})}).start()}},{key:"addListener",value:function(t){this.listeners.push(t)}},{key:"start",value:function(){this.counter&&this.counter.html(this.settings.startAt),this.current={time:this.settings.startAt},this.target={time:this.settings.endAt},this.setAnimator(this.current,this.target,this.settings.duration,this.settings.easing)}}]),t}(),_createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),NamePanel=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,t),this.imagesPath="./images/",this.components=[],this.html={},this.data=e}return _createClass(t,[{key:"_setComponents",value:function(t,e){var n=this,a=t.rawdata.multiplier?t.rawdata.multiplier:1,i=Math.ceil(t.rawdata[2015]*a),s={endAt:i,startAt:t.startAt?t.startAt:e.startAt,duration:t.duration?t.duration:e.duration,easing:TWEEN.Easing.Linear.None},r=new Counter(s);r.setParent(n.html.counter);var o=Math.ceil(t.rawdata[2014]*a),l="image"===t.indicator?new IndicatorImage(o):new IndicatorColor(o,!0);l.setParent(n.html.indicator),r.addListener(l),n.html.title.html(t.title),n.html.topIcon.append($('<img src="'+this.imagesPath+t.icon+'" alt="'+t.iconAltText+'">')),t.valueUnit&&n.html.topUnit.append($('<img src="'+this.imagesPath+t.valueUnit+'" alt="'+t.valueUnitAltText+'">')),n.html.topDescription.html(t.topDescription),n.html.btText.html(t.bottomPanel.topLabel),n.html.btValue.html(". . ."),n.html.bbText.html(t.bottomPanel.bottomLabel),n.html.bbValue.html(". . .");var u=new NameFlipper(n.data,{duration:t.duration?t.duration:e.duration});u.setParent(n.html.panelBottom),n.components.push(l),n.components.push(r),n.components.push(u)}},{key:"setPanel",value:function(t,e,n){this.html=DefaultHTML.generate(t),this._setComponents(e,n)}},{key:"start",value:function(){this.components.forEach(function(t){t.start()})}}]),t}(),_createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),DefaultPanel=function(){function t(){_classCallCheck(this,t),this.imagesPath="./images/",this.components=[],this.html={}}return _createClass(t,[{key:"_setComponents",value:function(t,e){var n=this,a=t.rawdata.multiplier?t.rawdata.multiplier:1,i=Math.ceil(t.rawdata[2015]*a),s={endAt:i,startAt:t.startAt?t.startAt:e.startAt,duration:t.duration?t.duration:e.duration};"Hauptwohnsitze"===t.title&&(s.easing=TWEEN.Easing.Sinusoidal.Out);var r=new Counter(s);r.setParent(n.html.counter);var o=Math.ceil(t.rawdata[2014]*a),l=!1;"Hauptwohnsitze"!=t.title&&"Bußgelder"!=t.title||(l=!0);var u="image"===t.indicator?new IndicatorImage(o):new IndicatorColor(o,l);u.setParent(n.html.indicator),r.addListener(u),n.html.title.html(t.title),n.html.topIcon.append($('<img src="'+this.imagesPath+t.icon+'" alt="'+t.iconAltText+'">')),t.valueUnit&&n.html.topUnit.append($('<img src="'+this.imagesPath+t.valueUnit+'" alt="'+t.valueUnitAltText+'">')),n.html.topDescription.html(t.topDescription),n.html.btText.html(t.bottomPanel.topLabel),n.html.btValue.html(t.bottomPanel.topValue),n.html.bbText.html(t.bottomPanel.bottomLabel),n.html.bbValue.html(t.bottomPanel.bottomValue),n.components.push(u),n.components.push(r)}},{key:"setPanel",value:function(t,e,n){this.html=DefaultHTML.generate(t),this._setComponents(e,n)}},{key:"start",value:function(){this.components.forEach(function(t){t.start()})}}]),t}(),_createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),DataLoader=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"loadData",value:function(t,e){var n="./data/"+t;return $.ajax({context:e,dataType:"json",url:n})}}]),t}(),_createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),Timeline=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,t),this.settings={cursorWidth:e.cursorWidth?e.cursorWidth:5,startAt:e.startAt?e.startAt:0,endAt:e.endAt?e.endAt:95,duration:e.duration?e.duration:5e3,easing:e.easing?e.easing:TWEEN.Easing.Linear.None,labels:e.labels?e.labels:["Jan.","Feb.","März","Apr.","Mai","Jun.","Jul","Aug","Sept.","Okt.","Nov.","Dez."]}}return _createClass(t,[{key:"setParent",value:function(t){this.slider=$(t).find(".slider"),this.label=this.slider.find(".label")}},{key:"setLabel",value:function(){this.slider.css({"margin-left":this.current.slider+"%"}),this.label.html(this.settings.labels[Math.floor(this.current.label)])}},{key:"setAnimator",value:function(t,e,n,a,i){this.animator=new TWEEN.Tween(t).to(e,n).easing(i).onUpdate(a).start()}},{key:"start",value:function(){this.current={label:this.settings.startAt,slider:this.settings.startAt},this.target={label:this.settings.labels.length-1,slider:this.settings.endAt},this.setAnimator(this.current,this.target,this.settings.duration,this.setLabel.bind(this),this.settings.easing)}}]),t}(),_createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),Dashboard=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,t),this.globalDefaults=e,this.isRunning=!1,this.panels=[]}return _createClass(t,[{key:"setup",value:function(t,e){var n=this,a=this;DataLoader.loadData("names.json").done(function(i){a.nameData=i,DataLoader.loadData("panels.json",n).done(function(n){a.panelData=n,a._setRestartButton(),a._createTimeline(e),a._createPanels(t,n),a.start(2e3)}).fail(function(t){console.error("error loading panel-data",t)})}).fail(function(t){console.error("error loading name-data",t)})}},{key:"start",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.isRunning=!0,setTimeout(function(){t.timeLine.start(),t.panels.forEach(function(t){t.start()}),window.requestAnimationFrame(t.update.bind(t))},e)}},{key:"update",value:function(t){this.isRunning&&(TWEEN.update(t),window.requestAnimationFrame(this.update.bind(this)))}},{key:"stop",value:function(){this.isRunning=!1,TWEEN.removeAll()}},{key:"_createTimeline",value:function(t){this.timeLine=new Timeline(this.globalDefaults),this.timeLine.setParent(t)}},{key:"_createPanels",value:function(t,e){var n=this;if(!e)throw new Error("No data to create panels from");var a=this;e.panels.forEach(function(e){var i=void 0;switch(e.panelTemplate){case"NamePanel":i=new NamePanel(a.nameData);break;default:i=new DefaultPanel}i.setPanel(t,e,n.globalDefaults),a.panels.push(i)})}},{key:"_setRestartButton",value:function(){var t=this;$(".restart").on("click",function(e){t.stop(),t.start(0)})}}]),t}();$(function(){var t={duration:12e4,startAt:0};$(".city").text("MOERS"),$(".header .date").text("2015"),$(".footer .description-positive").text("Positive Veränderung zu 2014"),$(".footer .description-negative").text("Negative Veränderung zu 2014"),$(".footer .explanation").text("Erklärung zu den Neugeborenen: Es werden zusätzlich zu der Anzahl der Neugeborenen die beliebtesten Vornamen dargestellt. Dabei werden die Namen der Häufigkeit nach sortiert. Die beliebtesten Vornamen werden gegen Ende des Jahres dargestellt, die am wenigsten vorkommenden Vornamen am Anfang des Jahres. Jedem Neugeborenen wird dabei ein Name zugeordnet, d.h. häufig gewählte Vornamen bleiben entsprechend länger sichtbar."),new Dashboard(t).setup(".panel-wrapper",".time-line")});